{% extends 'base.html' %}

{% block title %}Business Ecosystem - Herbo Bueno{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="ecosystem-hero">
    <div class="hero-overlay"></div>
    <div class="container">
        <div class="row align-items-center min-vh-50">
            <div class="col-lg-8 mx-auto text-center">
                <div class="hero-content">
                    <h1 class="hero-title">Business Ecosystem</h1>
                    <p class="hero-subtitle">Discover local businesses, scan QR codes, and earn points for amazing giveaways!</p>
                    <div class="hero-stats">
                        <div class="stat-item">
                            <div class="stat-number">{{ businesses|length }}+</div>
                            <div class="stat-label">Partner Businesses</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number">10-20</div>
                            <div class="stat-label">Points Per Visit</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number">3</div>
                            <div class="stat-label">Golden Ticket Locations</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Search and Filter Section -->
<section class="search-section">
    <div class="container">
        <div class="row mb-4">
            <div class="col-md-6">
                <form method="get" class="d-flex">
                    <input type="search" name="search" class="form-control me-2 search-input" placeholder="Search businesses or cities..." value="{{ search_query }}">
                    <button type="submit" class="btn btn-search">
                        <i class="fas fa-search"></i>
                    </button>
                </form>
            </div>
            <div class="col-md-3">
                <form method="get" class="d-flex">
                    <select name="category" class="form-select me-2 filter-select">
                        <option value="">All Categories</option>
                        {% for value, label in categories %}
                            <option value="{{ value }}" {% if selected_category == value %}selected{% endif %}>{{ label }}</option>
                        {% endfor %}
                    </select>
                    <button type="submit" class="btn btn-filter">
                        <i class="fas fa-filter"></i>
                    </button>
                </form>
            </div>
            <div class="col-md-3">
                <form method="get" class="d-flex">
                    <select name="city" class="form-select me-2 filter-select">
                        <option value="">All Cities</option>
                        {% for city in cities %}
                            <option value="{{ city }}" {% if selected_city == city %}selected{% endif %}>{{ city }}</option>
                        {% endfor %}
                    </select>
                    <button type="submit" class="btn btn-filter">
                        <i class="fas fa-map-marker-alt"></i>
                    </button>
                </form>
            </div>
        </div>
    </div>
</section>

<!-- Business Grid Section -->
<section class="businesses-section">
    <div class="container">
        <!-- Business Grid -->
        <div class="row g-4">
        {% for business in businesses %}
        <div class="col-md-6 col-lg-4">
            <div class="business-card h-100">
                <div class="card-image">
                    {% if business.banner_image %}
                        <img src="{{ business.banner_image.url }}" alt="{{ business.name }}" class="img-fluid">
                    {% else %}
                        <div class="placeholder-image">
                            <i class="fas fa-store"></i>
                        </div>
                    {% endif %}
                    {% if business.has_golden_ticket %}
                        <div class="golden-ticket-badge">
                            <i class="fas fa-crown"></i>
                            <span>Golden Ticket</span>
                        </div>
                    {% endif %}
                    <div class="category-badge">
                        {{ business.get_category_display }}
                    </div>
                </div>
                
                <div class="card-content">
                    <div class="business-header">
                        {% if business.logo %}
                            <img src="{{ business.logo.url }}" alt="{{ business.name }}" class="business-logo">
                        {% endif %}
                        <div class="business-info">
                            <h5 class="business-name">{{ business.name }}</h5>
                            <div class="business-location">
                                <i class="fas fa-map-marker-alt"></i>
                                <span>{{ business.city }}, {{ business.state }}</span>
                            </div>
                        </div>
                    </div>
                    
                    <p class="business-description">{{ business.description|truncatewords:15 }}</p>
                    
                    <div class="business-meta">
                        <div class="points-info">
                            <i class="fas fa-star"></i>
                            <span>{{ business.points_per_visit }} points</span>
                        </div>
                        <div class="hours-info">
                            <i class="fas fa-clock"></i>
                            <span>Open Now</span>
                        </div>
                    </div>
                    
                    <div class="card-actions">
                        <a href="{% url 'business_detail' business.id %}" class="btn btn-primary">
                            <i class="fas fa-eye me-1"></i>View Details
                        </a>
                        <a href="tel:{{ business.phone }}" class="btn btn-outline-secondary">
                            <i class="fas fa-phone"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
        {% empty %}
        <div class="col-12 text-center py-5">
            <div class="empty-state">
                <i class="fas fa-store fa-4x text-muted mb-4"></i>
                <h3 class="text-muted mb-3">No businesses found</h3>
                <p class="text-muted mb-4">Try adjusting your search or filter criteria.</p>
                <a href="{% url 'ecosystem_list' %}" class="btn btn-primary">
                    <i class="fas fa-refresh me-2"></i>View All Businesses
                </a>
            </div>
        </div>
        {% endfor %}
        </div>
    </div>
</section>

<!-- How It Works Section -->
<section class="how-it-works-section">
    <div class="container">
        <div class="row">
            <div class="col-12 text-center mb-5">
                <h2 class="section-title">How the Ecosystem Works</h2>
                <p class="section-subtitle">Earn points and win prizes in just 4 simple steps</p>
            </div>
        </div>
        <div class="row g-4">
            <div class="col-md-3 col-sm-6">
                <div class="step-card">
                    <div class="step-icon">
                        <i class="fas fa-search"></i>
                    </div>
                    <div class="step-number">1</div>
                    <h5 class="step-title">Find Businesses</h5>
                    <p class="step-description">Discover local businesses in your area that are part of our ecosystem.</p>
                </div>
            </div>
            <div class="col-md-3 col-sm-6">
                <div class="step-card">
                    <div class="step-icon">
                        <i class="fas fa-shopping-bag"></i>
                    </div>
                    <div class="step-number">2</div>
                    <h5 class="step-title">Make a Purchase</h5>
                    <p class="step-description">Visit the business and make a purchase for things you need.</p>
                </div>
            </div>
            <div class="col-md-3 col-sm-6">
                <div class="step-card">
                    <div class="step-icon">
                        <i class="fas fa-qrcode"></i>
                    </div>
                    <div class="step-number">3</div>
                    <h5 class="step-title">Scan QR Code</h5>
                    <p class="step-description">Scan the special QR code at the business to earn points.</p>
                </div>
            </div>
            <div class="col-md-3 col-sm-6">
                <div class="step-card">
                    <div class="step-icon">
                        <i class="fas fa-trophy"></i>
                    </div>
                    <div class="step-number">4</div>
                    <h5 class="step-title">Win Prizes</h5>
                    <p class="step-description">Use your points to enter giveaways and win amazing prizes!</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Golden Ticket CTA -->
<section class="golden-ticket-cta">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <div class="cta-card golden-ticket">
                    <div class="cta-content">
                        <div class="cta-icon">
                            <i class="fas fa-crown"></i>
                        </div>
                        <h3 class="cta-title">Golden Ticket Locations</h3>
                        <p class="cta-description">Some businesses have special golden tickets that give you 5x the points!</p>
                        <a href="{% url 'golden_ticket_locations' %}" class="btn btn-cta">
                            <i class="fas fa-map-marked-alt me-2"></i>Find Golden Tickets
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Join Ecosystem CTA -->
<section class="join-ecosystem-cta">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <div class="cta-card join-ecosystem">
                    <div class="cta-content">
                        <div class="cta-icon">
                            <i class="fas fa-handshake"></i>
                        </div>
                        <h3 class="cta-title">Want to Join Our Ecosystem?</h3>
                        <p class="cta-description">Join our network of local businesses and reach thousands of engaged customers.</p>
                        <a href="{% url 'business_signup' %}" class="btn btn-cta">
                            <i class="fas fa-plus me-2"></i>Join Ecosystem
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}
